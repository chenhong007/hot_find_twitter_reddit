# 更新日志

## [1.5.0] - 2025-11-20

### 🏗️ 代码重构与架构升级

- **模块化抓取引擎**
  - 重构了核心抓取逻辑，采用策略模式 (Strategy Pattern) 设计
  - 抽离出通用的 `PlatformScraper` 接口
  - 将 Twitter 和 Substack 的抓取逻辑拆分为独立的 Scraper 类
  - 提高了代码的可维护性和扩展性，方便未来接入更多平台

- **配置化管理**
  - 将硬编码的 CSS 选择器全部移至 `src/config/selectors.ts` 配置文件
  - 实现了对页面结构变化的快速响应，无需修改核心逻辑

- **组件化 UI 架构**
  - 将庞大的 `App.tsx` 拆分为多个独立组件：
    - `Header`: 顶部导航与操作区
    - `StatsCard`: 数据统计卡片
    - `FilterControls`: 阈值筛选控件
    - `TweetTable`: 虚拟滚动数据表格
  - 提升了代码的可读性和复用性

- **Custom Hooks 逻辑分离**
  - 抽离业务逻辑到自定义 Hooks：
    - `useTweets`: 管理数据抓取、存储与清理
    - `useExport`: 处理 CSV/JSON 数据导出
    - `useTweetFilter`: 负责数据的筛选、排序逻辑
  - 实现了视图层与逻辑层的完全解耦

- **通用工具库**
  - 创建 `src/utils.ts` 统一管理数字解析、日期处理等通用函数

### 🐞 问题修复
- 修复了构建时的 `sortField` 未使用报错
- 优化了表格排序 UI，添加了排序方向指示器 (▲/▼)

## [1.4.0] - 2025-11-20

### 🌍 多平台支持

- **新增 Substack 支持**
  - 全面支持 `https://substack.com/home` 页面数据抓取
  - 自动识别并提取文章序号、链接、作者、发布时间、内容摘要
  - 支持抓取 Substack 特有的互动指标：
    - Likes (爱心)
    - Comments (留言数)
    - Restacks (转发数)
  - 列表"来源"列自动区分 Twitter 和 Substack 内容

### 🛠️ 核心优化

- **智能 DOM 解析**
  - 针对 Substack Home 复杂的页面布局，重写了 DOM 解析器
  - 增加多种 CSS 选择器兼容不同版式 (Reader/Post Preview)
  - 优化了数据清洗逻辑，确保跨平台数据格式统一

## [1.3.0] - 2025-11-20

### ✨ 新增功能

- **双击复制整列内容**
  - 在"内容"列表头添加双击事件
  - 双击即可一键复制当前筛选结果中的所有推文内容
  - 方便进行后续的数据分析和处理

- **高级数据过滤**
  - 新增最低阈值设置功能
  - 支持对评论数、转发数、点赞数、阅读数进行自定义过滤
  - 实时隐藏低于设定阈值的推文，让数据筛选更精准

## [1.2.2] - 2025-11-19

### ⚡ 性能革命性提升

- **引入虚拟滚动 (Virtual Scrolling)**
  - 引入 `react-window` 库，实现长列表虚拟化渲染
  - 无论抓取多少数据（3000+条），始终只渲染可视区域内的 ~15 个 DOM 节点
  - 彻底解决了内存占用过高和页面卡顿的问题
- **抓取逻辑优化**
  - 引入 "ID 预检" 机制：在进行昂贵的 DOM 解析前，先通过 URL 判断推文是否已存在
  - 移除递归 `setTimeout` 重试机制，消除闭包导致的内存泄漏风险
  - 优化后 CPU 和内存占用大幅下降

### 🐛 Bug 修复

- 修复了构建时的 TypeScript 编译错误

## [1.2.1] - 2025-11-19

### 🔧 维护与优化

- **构建系统**：升级版本号以验证构建流程
- **代码检查**：执行编译检查以修复潜在错误

## [1.2.0] - 2025-11-19

### 🎨 UI/UX 优化

- **统计卡片重构**：采用横向4列布局，完全匹配设计稿
  - 添加2px黑色外框线 (`border-2 border-gray-900`)
  - 添加垂直内框线分隔各指标 (`divide-x divide-gray-900`)
  - 统一边框样式，视觉效果更专业

### 📊 数字显示优化

- **智能数字格式化**：实现 `formatStatNumber()` 函数，保留4位有效数字
  - 超大数字（≥10¹⁵）：使用科学计数法（如 `3.42e+15`）
  - 中大数字（≥10⁹）：使用"亿"单位（如 `123.5亿`）
  - 中等数字（≥10⁶）：使用"万"单位（如 `456.7万`）
  - 小数字（≥10⁴）：使用K单位（如 `12.3K`）
  - 避免数字溢出边框，提升可读性
  
- **表格数据简短格式**：评论数、转发数、点赞数、阅读数全部使用简短格式
  - 示例：`318K`、`203.9K`、`119.6K`、`52.1K`
  - 提升表格数据密度和可读性

### ⚡ 性能优化

- **抓取速度提升**
  - 将抓取间隔从 2秒 缩短到 1秒（**提速 50%**）
  - 增加滚动距离：从 300-700px 增加到 500-1100px（**提速 70%**）
  - 批量处理数据，先抓取后排序，减少通信开销

### 🛡️ 稳定性增强

- **纠错机制**
  - 添加最大重试次数（MAX_RETRIES = 3）
  - 数据提取失败时自动重试
  - 消息发送失败延迟1秒后重试
  - 增加 try-catch 保护关键操作
  - 成功后自动重置重试计数器

### 🎯 表格样式优化

- 外框使用 2px 黑色边框，视觉更清晰
- 表头背景色改为灰色，字体加粗
- 单元格内容加粗，提升可读性
- 添加 hover 效果，改善交互体验

### 🔧 技术栈更新

- 添加 `tailwindcss@^3.4.1` - CSS框架
- 添加 `postcss@^8.4.35` - CSS处理器
- 添加 `autoprefixer@^10.4.17` - 浏览器前缀

---

## [1.1.0] - 2025-11-19

### 新增功能

- 添加日期选择器，支持自定义查询日期
- 优化界面布局，严格按照新设计规范

### 界面优化

- 重新设计顶部标题栏，布局更加简洁清晰
- 统计卡片采用科学计数法显示大数字
- 优化表格样式，使用灰色边框替代黑色粗边框
- 调整背景色为纯白色，提升视觉体验
- 简化操作按钮，保留核心功能

### 技术改进

- 移除未使用的依赖和代码
- 优化组件结构，提升性能
- 代码质量检查通过，无 lint 错误

---

## [1.0.0] - 2025-11-18

### 初始版本

- 实现 Twitter/X 推文爆文数据抓取功能
- 支持实时数据展示和更新
- 提供推文列表展示，包含作者、内容、互动数据等
- 支持按点赞数、转发数、评论数、阅读数排序
- 侧边栏面板设计，方便使用
- 统计数据展示：总推文数、总点赞数、总转发数、平均互动率